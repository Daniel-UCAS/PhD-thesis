\chapter{Turbulence models}
\doublespace

In this chapter the three eddy viscosity RANS and one LES turbulence models used
throughout this work are detailed. Note that since all of these were applied via
\textit{OpenFOAM}, their exact implementation can be interrogated by looking at
the source code, which is freely available.

The exact incompressible RANS equations are written as
\begin{equation}
    \frac{\partial U_i}{\partial t}
    + U_j \frac{\partial U_i}{\partial x_j}
    =
    -\frac{1}{\rho}\frac{\partial P}{\partial x_i}
    - \frac{\partial}{\partial x_j} \overline{u_i^\prime u_j^\prime}
    + \nu \frac{\partial^2 U_i}{\partial x_j \partial x_j}
\end{equation}

The RANS equations with the eddy viscosity formulation are modified with the
relation $-\overline{u_i^\prime u_j^\prime} = 2 \nu_t S_{ij}$, where $nu_t$ is
the turbulence viscosity and $S_{ij}$ is the mean strain rate tensor. The RANS
equations with the eddy viscosity approximation then become
\begin{equation}
    \frac{\partial U_i}{\partial t}
    + U_j \frac{\partial U_i}{\partial x_j}
    =
    -\frac{1}{\rho}\frac{\partial P}{\partial x_i}
    + (\nu + \nu_t) \frac{\partial^2 U_i}{\partial x_j \partial x_j}.
\end{equation}


\section{Spalart--Allmaras}

The Spalart--Allmaras turbulence model is based on the transport of a single
scalar $\tilde{\nu}$ \cite{Spalart1992}, which is designed to behave linearly
near the wall. The transport equation for $\tilde{\nu}$ is defined as

% Eq. 9 from Spalart1992 (or 1994)
\begin{equation}
    \frac{\mathrm{D} \tilde{\nu}}{\mathrm{D} t}
    = c_{b1} \tilde{S} \tilde{\nu}
    + \frac{1}{\sigma}
    \left[
    \nabla \cdot \left( (\nu + \tilde{\nu}) \nabla \tilde{\nu} \right)
    + c_{b2} (\nabla \tilde{\nu})^2
    \right]
    - c_{w1} f_w \left[ \frac{\tilde{\nu}}{d} \right]^2,
    \label{eq:SA-nutilde}
\end{equation}

% Stilda from OpenFOAM
\begin{equation}
    \tilde{S} = f_{v3}\sqrt{2} | \mathrm{skew} \nabla U |
    + f_{v2} \frac{\tilde{\nu}}{\kappa^2 d^2},
\end{equation}
where $\mathrm{skew} \nabla U$ is the skew-symmetric component of the velocity gradient
tensor.

%fv2 and fv3 from OpenFOAM (no Ashford correction)
\begin{equation}
    f_{v2} = 1 - \frac{\chi}{1 + \chi f_{v1}}, \, \, \,
    f_{v3} = 1
\end{equation}

% From OpenFOAM: Cw1_(Cb1_/sqr(kappa_) + (1.0 + Cb2_)/sigmaNut_)
\begin{equation}
    c_{w1} = c_{b1}/\kappa^2 + \frac{1 + c_{b2}}{\sigma}
\end{equation}

\begin{equation}
    f_w(r) = g \left[ \frac{1 + c_{w3}^6}{g^6 + c_{w3}^6} \right]^{1/6}
\end{equation}

\begin{equation}
    g = r + c_{w2} (r^6 - r)
\end{equation}

\begin{equation}
    f = \frac{\tilde{\nu}}{\tilde{S} \kappa^2 d^2}
\end{equation}

$d$ is the distance to the wall.

The SA turbulent viscosity is defined as $\nu_t = f_{v1} \tilde{\nu}$.

Typical coefficients are
\begin{equation}
    c_{b1} = 0.1355, \, \,
    c_{b2} = 0.622, \, \,
    c_{w2} = 0.3, \, \,
    c_{w3} = 2.0, \, \,
    c_{v1} = 7.1, \, \,
    c_{v2} = 5.0, \, \,
    \sigma = 0.66666, \, \,
    \kappa = 0.41
\end{equation}


\section{$k$--$\omega$ SST}

Menter's $k$--$\omega$ SST is defined as \cite{Menter2001}

\begin{equation}
    \rho \frac{\partial k}{\partial t}
    + \rho U_j \frac{\partial k}{\partial x_j}
    = \tilde{P}_k - \rho \beta^* \omega k
    + \frac{\partial}{\partial x_j}
    \left(
    \Gamma_k \frac{\partial k}{\partial x_j}
    \right)
    \label{eq:komegasst-k}
\end{equation}

\textit{OpenFOAM}'s implementation of the SST model features updated
coefficients from \cite{Menter2003}, with the consistent production terms from
\cite{Menter2001}/


\section{$k$--$\epsilon$}

The standard $k$--$\epsilon$ model is defined as \cite{Wilcox1994}

\begin{equation}
    \nu_t = C_\mu k^2 / \epsilon,
    \label{eq:kepsilon-nut}
\end{equation}

\begin{equation}
    \rho \frac{\partial k}{\partial t}
    + \rho U_j \frac{\partial k}{\partial x_j}
    = \tau_{ij} \frac{\partial U_i}{\partial x_j}
    - \rho \epsilon
    + \frac{\partial}{\partial x_j}
    \left[
    (\mu + \mu_t/\sigma_k) \frac{\partial k}{\partial x_j}
    \right]
    \label{eq:kepsilon-k}
\end{equation}

\begin{equation}
    \rho \frac{\partial \epsilon}{\partial t}
    + \rho U_j \frac{\partial \epsilon}{\partial x_j}
    = C_{\epsilon 1} \frac{\epsilon}{k} \tau_{ij}
    \frac{\partial U_i}{\partial x_j}
    - C_{\epsilon 2} \rho \frac{\epsilon^2}{k}
    + \frac{\partial}{\partial x_j}
    \left[
    (\mu + \mu_t/\sigma_k) \frac{\partial \epsilon}{\partial x_j}
    \right]
    \label{eq:kepsilon-epsilon}
\end{equation}

Typical closure coefficients are

\begin{equation}
    C_{\epsilon 1} = 1.44, \, \,
    C_{\epsilon 2} = 1.92, \, \,
    C_\mu = 0.09, \, \,
    \sigma_k = 1.0, \, \,
    \sigma_\epsilon = 1.3
\end{equation}


\section{Smagorinsky LES model}

Large eddy simulation solves for the filtered velocity field $\tilde{u}$. The
filtered Navier--Stokes equations are

\todo[inline]{Get the correct form of the filtered pressure $p^*$ for LES.}

\begin{equation}
    \frac{\partial \tilde{u}_i}{\partial t}
    + \tilde{u}_j \frac{\partial \tilde{u}_i}{\partial x_j}
    = - \frac{1}{\rho} \frac{\partial \tilde{p}}{\partial x_i}
    + \nu \frac{\partial^2 \tilde{u}_i}{\partial x_j \partial x_j}
    - \frac{\partial \tau_{ij}}{\partial x_j}
    \label{eq:filtered-ns}
\end{equation}

Smagorinsky~\cite{Smagorinsky1963} proposed an eddy viscosity type relation for
the computing the subgrid scale (SGS) stress tensor $\tau_{ij}$.

% From Wilcox 1994 Eq 8.32
\begin{equation}
    \tau_{ij} = 2 \mu_t S_{ij}, \, \, \,
    S_{ij} = \frac{1}{2}
    \left(
    \frac{\partial \tilde{u}_i}{\partial u_j}
    + \frac{\partial \tilde{u}_j}{\partial u_i}
    \right)
\end{equation}

The eddy viscosity is then
\begin{equation}
    \mu_t = \rho (C_S \Delta)^2 \sqrt{\tilde{S}_{ij} \tilde{S}_{ij}},
\end{equation}
where $C_S$ is the Smagorinsky coefficient, which is not universal, i.e., will
vary for different flow conditions.


\subsection{\textit{OpenFOAM}'s implementation}

\todo[inline]{Add OpenFOAM's calculation of $C_s$.}

% From OpenFOAM
\begin{equation}
    \mathbf{B} = \frac{2}{3}k \mathbf{I}
    - 2 \nu_{\mathrm{SGS}} \mathrm{dev} \mathbf{D}
\end{equation}

\begin{equation}
    \mathbf{D} = \mathrm{symm} \nabla U
\end{equation}

\begin{equation}
    \nu_{\mathrm{SGS}} = C_k \sqrt{k} \Delta
\end{equation}

\begin{equation}
    k =
    (
    -2/3 \mathbf{D}_{ii} + \sqrt{(2/3 \mathbf{D}_{ii})^2
    + 4C_\epsilon \Delta 2 C_k \Delta
    (\mathrm{dev} \mathbf{D} \cdot \mathbf{D})}
    / (2 C_\epsilon / \Delta)
    )^2
\end{equation}

Default model coefficients are
\begin{equation}
    C_k = 0.094, \, \, \,
    C_\epsilon = 1.048
\end{equation}
