\chapter{Developing an actuator line model for cross-flow turbines}

After getting a sense for how two different turbines perform, and how they
affect the flow in which they are placed, the goal is to now develop a way to
predict these effects without resorting to blade-resolved Navier--Stokes CFD.

The ultimate goal of the actuator line model is to drive down the computational
costs of simulating turbines by negating the need for complicated meshing, and
the subsequent boundary layer resolution.

The ALM is based on the classical blade element theory, developed by
\todo[inline]{Find citation for creator of blade element theory}
and subsequently first implemented by Sorensen and Shen \cite{Sorensen2002}.

% % % Below from introduction

The actuator line model, originally developed by Sorensen and Shen
\cite{Sorensen2002}, treats turbine blades as lines of blade elements, for which
2-D foil lift and drag coefficients are tabulated. For any given blade element,
relative flow velocity and angle of attack are computed by adding the vectors
of relative blade motion and the local fluid velocity. The blade lift and drag
forces are calculated using

\begin{equation}
F_L = \frac{1}{2} \rho A_\mathrm{elem} C_L U_\mathrm{rel}^2,
\end{equation}
and
\begin{equation}
F_D = \frac{1}{2} \rho A_\mathrm{elem} C_D U_\mathrm{rel}^2,
\end{equation}
where $\rho$ is the fluid density, $A_\mathrm{elem}$ is the blade element
planform area (span $\times$ chord), $U_\mathrm{rel}$ is the local relative
velocity, and $C_L$ and $C_D$ are the sectional lift and drag coefficients,
chosen from a table via the local angle of attack and typically the Reynolds
number. The forces are then projected onto the rotor coordinate system to
calculate torque, overall drag, etc. Forces from the turbine shaft and blade
support struts will be computed in a similar way.

The use of static foil data necessitates corrections for various dynamic effects
induced by the the actuator lines rotating within the flow field. Dynamic stall
may be encountered when the blade angle of attack increases past a certain
threshold, and is characterized by an initial increase in lift as a vortex is
shed from the foil's leading edge, after which a drop in lift occurs as the
vortex is advected downstream. Dynamic stall has been shown to be a significant
positive contributor to performance in CFTs \cite{Para2002, Urbina2013}, so it
is important to choose an accurate model. Following common examples in the
literature, including CACTUS, we will start with the Leishmann--Beddoes model
due to its favorable performance in, for example, Scheurich and Brown
\cite{Scheurich2011}. The dynamic stall model will also likely benefit from the
low Mach number modification of Sheng et al. \cite{Sheng2008}.

Other dynamic loading considerations stem from the blade rotation and
acceleration---so-called pitching circulation, flow curvature, and added-mass
effects. We will start by using the correction methodology of CACTUS, which is
based on an analogy with a pitching flat plate, using the nondimensional pitch
rate of the blade element to correct normal and tangential force coefficients
\cite{Murray2011}. It is possible that these corrections will not produce
adequate results, but by using the Navier--Stokes equations to solve the flow
field we at least will have removed the uncertainty due to wake vortex
instability discussed in Michelen et al. \cite{Michelen2014}.

There is an important difference, however, in the way the body force is imparted
on the flow field. In the vortex method, singularities exist by design, but in a
Navier--Stokes simulation on a grid, a singularity of force caused by, e.g., a
blade element in a single cell, can cause numerical instability. We will adopt
the Gaussian projection method of Sorensen and Shen \cite{Sorensen2002}, which
is also used in the National Renewable Energy Laboratory's (NREL) Simulator for
Wind Farm Applications (SOWFA), a comprehensive library for ALM/LES wind farm
simulations in OpenFOAM \cite{Churchfield2013}.

If the proposed body force model is inadequate for postdicting our experimental
performance data, one possible strategy for improving accuracy is to generate
foil coefficient databases with more dimensions, e.g., blade pitch rate or local
turbulence levels. It may also be possible to modify the dynamic loading models
based on insight from the body-fitted grid simulations.

% % % Above from introduction

\section{Model inputs}

% Not multiple Re coefficient tables!

\section{Blade element discretization}

In the ALM, a turbine is a collection of actuator lines, which themselves are
collections of actuator line elements (ALEs). The position of each ALE is a
point in space indicating the quarter-chord location of the element
cross-section. The element is further defined by its chord direction vector,
chord length, span direction vector, span length, and velocity vector.

\section{Force projection}

After the force on the ALE from the flow is calculated, it is then projected
back onto the flow field as a source term in the momentum equation. To avoid
instability due to sharp gradients, the source term is tapered from its maximum
value away from the element location by means of a spherical Gaussian function.
The width of this function is
\todo[inline]{Add final width of Gaussian projection}

\section{Unsteady aerodynamics}

In the context of a turbine---especially a cross-flow turbine---the actuator
lines will encounter unsteady conditions, both in their angle of attack and
relative velocity. These conditions necessitate the use of unsteady aerodynamic
models to augment the static foil characteristics. Furthermore, the angles of
attack encountered by a CFT blade will often be high enough to encounter dynamic
stall. It is therefore necessary to model both unsteady attached and detached
flow to obtain accurate loading predictions.

Leishman and Beddoes developed a semi-empirical model for unsteady aerodynamics
and dynamic stall, which is derived from the phenomenology of the physics
instead rather than pure empiricism \cite{Leishman1989}.

\section{Flow curvature corrections}

The rotating blades of a cross-flow turbine will have varying angle of attack
along their chords for any given azimuthal location due to the circular path.
This makes it difficult to define a single angle of attack for use in the static
coefficient lookup tables. Furthermore, this effect is more pronounced for high
solidity ($c/R$) turbines.


\section{Reynolds number corrections}

As seen in Chapter~\ref{chap:Re-dep}, Reynolds number can have significant
effects on turbine performance below a threshold value. To maintain accuracy
using a single static foil data table in a flow of varying inflow velocity
magnitude, Reynolds number corrections should be applied. Yamauchi and Johnson
\cite{Yamauchi1983} proposed a simple correction derived from turbulent flat
plate boundary layer results, where the drag coefficient is corrected as
\begin{equation}
C_d = C_{d_{\mathrm{table}}}/ K,
\label{eq:cd-correction}
\end{equation}
where $K = f(Re)/f(Re_\mathrm{table})$. There are several choices for the
scaling function $f(Re)$:
\begin{equation}
f(Re) = Re^{-0.5},
\end{equation}
\begin{equation}
f(Re) = Re^{-0.2},
\end{equation}
\begin{equation}
f(Re) = \frac{0.455}{\ln Re}2.58 - \frac{A}{Re},
\end{equation}
\begin{equation}
f(Re) = (3.46 \ln Re - 5.6)^{-2},
\end{equation}
or
\begin{equation}
f(Re) = (\ln Re - 0.407)^{-2.64}.
\end{equation}

Yamauchi and Johnson propose a correction for the lift coefficient that will keep the lift slope constant, i.e.
\begin{equation}
C_l = K C_{l_\mathrm{table}} (\alpha/K),
\end{equation}
where
\begin{equation}
K = \alpha_{\max} / \alpha_{\max_\mathrm{table}} = C_{l_{\max}} /
C_{l_{\max_\mathrm{table}}}.
\end{equation}
The scaling constant is chosen as
\begin{equation}
K = \left( Re/Re_\mathrm{table} \right)^n,
\end{equation}
where $n$ is a small positive number between approximately 0.125 and 0.2.

Figure~\ref{fig:Re-corrections} shows the results of the chosen Reynolds number
correction compared with foil data taken at multiple $Re$.

\begin{figure}
\caption{Reynolds number corrections compared with foil data acquired at
multiple Reynolds numbers.}
\label{fig:Re-corrections}
\end{figure}

Note that these Reynolds number corrections are applied before the dynamic stall
model, such that the changes in e.g. the Kirchoff flow equation fit parameters
$S_1$ and $S_2$ will be changed automatically as well.


\section{Effects on turbulence modeling}

Conventional blade element simulations use either momentum or vortex methods to
solve for the incident flow field, and these methods do not model the effects of
turbulence. With the actuator line model, there is the opportunity to improve
the physical realism by not only adding a source to the momentum equations, but
also to the turbulence model equations.

James et al. implemented an actuator disk model in a RANS model with a
$k$--$\epsilon$ closure, which ``injected'' $k$ and $\epsilon$ from the actuator
disks to more realistically simulate the turbine's turbulent wake and enhance
momentum transport \cite{James2010}. However, to the author's knowledge
injecting turbulence quantities has never been done in an actuator line model.

In this case, we seek to inject turbulence dependent on blade loading, both
for the $k$--$\epsilon$ RANS model and the
\todo[inline]{Pick LES model to work with.}


\section{Software implementation}

The cross-flow turbine actuator line model (CFT-ALM) will be written into an
extension library for the OpenFOAM free and open-source CFD library. OpenFOAM is
in general a package for solving partial differential equations using the finite
volume method. However, it contains many pre-built applications for meshing,
pre-processing, solving, and post-processing CFD simulations. The library
contains implementations of models for compressible and incompressible flow,
turbulence via RANS, LES, and detatched eddy simulation (DES), multiphase flows,
dynamic mesh handling, and more, making it a very powerful general purpose
simulation framework, capable of easily scaling to massively parallel high
performance computing clusters. OpenFOAM is also widely used throughout industry
and academia, making it a perfect library in which to integrate this model, with
respect to potential impact and adoption.

The code will be written in OpenFOAM's style, similar to NREL's SOWFA, but will
use OpenFOAM's \texttt{fvOptions} framework for adding source terms to equations
at runtime. This strategy will allow the CFT-ALM to be added to many of the
solvers included in OpenFOAM, meaning it can be readily used with RANS or LES,
multiphase models (e.g. for simulating the free surface in MHK installations),
and even with heat transfer. Furthermore, unlike SOWFA, custom solvers will not
need to be developed to include the CFT-ALM. It is also likely that the
extension library developed here will be expanded to include axial flow turbine
models similar to SOWFA.

Since all applications are run from a command line and all input data is text
based, automation and integration with other tools is relatively
straightforward. Future enhancements could include cooperation with software for
generating static foil data, e.g., XFOIL or other OpenFOAM solvers, turbine
controller models, structural analysis codes, and optimization tools, e.g.,
SNL's DAKOTA, for both individual turbines and array layouts.


\section{Results}

\subsection{RANS}

\subsection{LES}

\section{Computational cost}
% Compare with the blade-resolved RANS